import{k as v,A as I,c as P}from"./MarkdownCode.svelte_svelte_type_style_lang-BB-itM20.js";var N=function(e,r,t){for(var n=t,l=0,i=e.length;n<r.length;){var c=r[n];if(l<=0&&r.slice(n,n+i)===e)return n;c==="\\"?n++:c==="{"?l++:c==="}"&&l--,n++}return-1},H=function(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")},S=/^\\begin{/,X=function(e,r){for(var t,n=[],l=new RegExp("("+r.map(f=>H(f.left)).join("|")+")");t=e.search(l),t!==-1;){t>0&&(n.push({type:"text",data:e.slice(0,t)}),e=e.slice(t));var i=r.findIndex(f=>e.startsWith(f.left));if(t=N(r[i].right,e,r[i].left.length),t===-1)break;var c=e.slice(0,t+r[i].right.length),h=S.test(c)?c:e.slice(r[i].left.length,t);n.push({type:"math",data:h,rawData:c,display:r[i].display}),e=e.slice(t+r[i].right.length)}return e!==""&&n.push({type:"text",data:e}),n},q=function(e,r){var t=X(e,r.delimiters);if(t.length===1&&t[0].type==="text")return null;for(var n=document.createDocumentFragment(),l=0;l<t.length;l++)if(t[l].type==="text")n.appendChild(document.createTextNode(t[l].data));else{var i=document.createElement("span"),c=t[l].data;r.displayMode=t[l].display;try{r.preProcess&&(c=r.preProcess(c)),v.render(c,i,r)}catch(h){if(!(h instanceof v.ParseError))throw h;r.errorCallback("KaTeX auto-render: Failed to parse `"+t[l].data+"` with ",h),n.appendChild(document.createTextNode(t[l].rawData));continue}n.appendChild(i)}return n},B=function a(e,r){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType===3){for(var l=n.textContent,i=n.nextSibling,c=0;i&&i.nodeType===Node.TEXT_NODE;)l+=i.textContent,i=i.nextSibling,c++;var h=q(l,r);if(h){for(var f=0;f<c;f++)n.nextSibling.remove();t+=h.childNodes.length-1,e.replaceChild(h,n)}else t+=c}else n.nodeType===1&&function(){var _=" "+n.className+" ",u=r.ignoredTags.indexOf(n.nodeName.toLowerCase())===-1&&r.ignoredClasses.every(d=>_.indexOf(" "+d+" ")===-1);u&&a(n,r)}()}},F=function(e,r){if(!e)throw new Error("No element provided to render");var t={};for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n]);t.delimiters=t.delimiters||[{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0},{left:"\\[",right:"\\]",display:!0}],t.ignoredTags=t.ignoredTags||["script","noscript","style","textarea","pre","code","option"],t.ignoredClasses=t.ignoredClasses||[],t.errorCallback=t.errorCallback||console.error,t.macros=t.macros||{},B(e,t)};const K=(a,e)=>{try{return!!a&&new URL(a).origin!==new URL(e).origin}catch{return!1}};function y(a,e){const r=new I,t=new DOMParser().parseFromString(a,"text/html");return M(t.body,"A",n=>{n instanceof HTMLElement&&"target"in n&&K(n.getAttribute("href"),e)&&(n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"))}),r.sanitize(t).body.innerHTML}function M(a,e,r){a&&(a.nodeName===e||typeof e=="function")&&r(a);const t=a?.childNodes||[];for(let n=0;n<t.length;n++)M(t[n],e,r)}const{SvelteComponent:U,attr:V,binding_callbacks:W,detach:j,element:G,flush:g,init:J,insert:Q,noop:E,safe_not_equal:Y,toggle_class:w}=window.__gradio__svelte__internal,{afterUpdate:Z,tick:ae}=window.__gradio__svelte__internal;function $(a){let e;return{c(){e=G("span"),V(e,"class","md svelte-7ddecg"),w(e,"chatbot",a[0]),w(e,"prose",a[1])},m(r,t){Q(r,e,t),e.innerHTML=a[3],a[11](e)},p(r,[t]){t&8&&(e.innerHTML=r[3]),t&1&&w(e,"chatbot",r[0]),t&2&&w(e,"prose",r[1])},i:E,o:E,d(r){r&&j(e),a[11](null)}}}function T(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ee(a,e){const r=e.map(n=>({open:new RegExp(`<(${n})(\\s+[^>]*)?>`,"gi"),close:new RegExp(`</(${n})>`,"gi")}));let t=a;return r.forEach(n=>{t=t.replace(n.open,(l,i,c)=>`&lt;${i}${c||""}&gt;`),t=t.replace(n.close,(l,i)=>`&lt;/${i}&gt;`)}),t}function te(a,e,r){let{chatbot:t=!0}=e,{message:n}=e,{sanitize_html:l=!0}=e,{latex_delimiters:i=[]}=e,{render_markdown:c=!0}=e,{line_breaks:h=!0}=e,{header_links:f=!1}=e,{root:_}=e,{allow_tags:u=null}=e,d,b;const p=P({header_links:f,line_breaks:h,latex_delimiters:i||[]});function L(s){let o=s;if(c){const m=[];i.forEach((x,k)=>{const R=T(x.left),A=T(x.right),C=new RegExp(`${R}([\\s\\S]+?)${A}`,"g");o=o.replace(C,(z,re)=>(m.push(z),`%%%LATEX_BLOCK_${m.length-1}%%%`))}),o=p.parse(o),o=o.replace(/%%%LATEX_BLOCK_(\d+)%%%/g,(x,k)=>m[parseInt(k,10)])}return u&&(o=ee(o,u)),l&&y&&(o=y(o,_)),o}async function D(s){i.length>0&&s&&i.every(m=>s.includes(m.left)&&s.includes(m.right))&&F(d,{delimiters:i,throwOnError:!1})}Z(async()=>{d&&document.body.contains(d)?await D(n):console.error("Element is not in the DOM")});function O(s){W[s?"unshift":"push"](()=>{d=s,r(2,d)})}return a.$$set=s=>{"chatbot"in s&&r(0,t=s.chatbot),"message"in s&&r(4,n=s.message),"sanitize_html"in s&&r(5,l=s.sanitize_html),"latex_delimiters"in s&&r(6,i=s.latex_delimiters),"render_markdown"in s&&r(1,c=s.render_markdown),"line_breaks"in s&&r(7,h=s.line_breaks),"header_links"in s&&r(8,f=s.header_links),"root"in s&&r(9,_=s.root),"allow_tags"in s&&r(10,u=s.allow_tags)},a.$$.update=()=>{a.$$.dirty&16&&(n&&n.trim()?r(3,b=L(n)):r(3,b=""))},[t,c,d,b,n,l,i,h,f,_,u,O]}class ie extends U{constructor(e){super(),J(this,e,te,$,Y,{chatbot:0,message:4,sanitize_html:5,latex_delimiters:6,render_markdown:1,line_breaks:7,header_links:8,root:9,allow_tags:10})}get chatbot(){return this.$$.ctx[0]}set chatbot(e){this.$$set({chatbot:e}),g()}get message(){return this.$$.ctx[4]}set message(e){this.$$set({message:e}),g()}get sanitize_html(){return this.$$.ctx[5]}set sanitize_html(e){this.$$set({sanitize_html:e}),g()}get latex_delimiters(){return this.$$.ctx[6]}set latex_delimiters(e){this.$$set({latex_delimiters:e}),g()}get render_markdown(){return this.$$.ctx[1]}set render_markdown(e){this.$$set({render_markdown:e}),g()}get line_breaks(){return this.$$.ctx[7]}set line_breaks(e){this.$$set({line_breaks:e}),g()}get header_links(){return this.$$.ctx[8]}set header_links(e){this.$$set({header_links:e}),g()}get root(){return this.$$.ctx[9]}set root(e){this.$$set({root:e}),g()}get allow_tags(){return this.$$.ctx[10]}set allow_tags(e){this.$$set({allow_tags:e}),g()}}export{ie as M};
//# sourceMappingURL=MarkdownCode-CKlPsAWp.js.map
